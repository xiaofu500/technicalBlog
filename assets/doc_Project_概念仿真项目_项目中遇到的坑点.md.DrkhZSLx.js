import{At as e,ct as t,s as n,ut as r}from"./chunks/framework.DGAZ-G8q.js";const i=JSON.parse(`{"title":"typesdeclaration 类型声明应用开发","description":"","frontmatter":{},"headers":[],"relativePath":"doc/Project/概念仿真项目/项目中遇到的坑点.md","filePath":"doc/Project/概念仿真项目/项目中遇到的坑点.md"}`);var a={name:`doc/Project/概念仿真项目/项目中遇到的坑点.md`};function o(n,i,a,o,s,c){return e(),t(`div`,null,[...i[0]||=[r(`<h1 id="typesdeclaration-类型声明应用开发" tabindex="-1">typesdeclaration 类型声明应用开发 <a class="header-anchor" href="#typesdeclaration-类型声明应用开发" aria-label="Permalink to &quot;typesdeclaration 类型声明应用开发&quot;">​</a></h1><h2 id="环境及依赖" tabindex="-1">环境及依赖 <a class="header-anchor" href="#环境及依赖" aria-label="Permalink to &quot;环境及依赖&quot;">​</a></h2><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">typescript</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rollup 打包工具</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@rollup</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">plugin</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">node</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">resolve</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@rollup</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">plugin</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">typescript</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">@rollup</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">plugin</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">alias</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">rollup</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">plugin</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">dts</span></span></code></pre></div><h2 id="rollupconfig-配置" tabindex="-1">rollupconfig 配置 <a class="header-anchor" href="#rollupconfig-配置" aria-label="Permalink to &quot;rollupconfig 配置&quot;">​</a></h2><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;input&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;src/index.ts&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;globals&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;cesium&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Cesium&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  },</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;output&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;file&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dist/index.d.ts&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">      &quot;format&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;es&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  ],</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;plugins&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">dts()</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h2 id="项目中遇到的坑点" tabindex="-1">项目中遇到的坑点 <a class="header-anchor" href="#项目中遇到的坑点" aria-label="Permalink to &quot;项目中遇到的坑点&quot;">​</a></h2><ol><li>package.json 配置 <ul><li>配置错误导致项目中 代码解析和声明文件解析入口不对，导致项目中使用 import 引入模块时，无法解析模块的类型声明文件。 package.json 中 main:&quot;dist/index.js&quot; //打包后，项目的入口文件 types:&quot;dist/index.d.ts&quot; //打包后，项目的类型声明文件 type : &quot;module&quot; // 项目采用的模块规范</li></ul></li><li>类型声明文件打包 <ul><li>本项目中 vite 不会顺着 index.d.ts 文件索引，导致解析失败</li><li>代码打包和类型声明文件打包分两个模块进行</li><li>类型声明文件打包到一个类型声明文件中</li><li>具体配置看上边(rollupconfig.json )</li><li>枚举类型需要在 tsconfig.json 中单独配置，防止被 treeshaking 优化掉</li></ul></li><li>vite 引用时，清理 pnpm 包中缓存（pnpm store prune）， 需：深挖 pnpm 缓存机制和 vite 运行时编译机制</li></ol>`,7)]])}var s=n(a,[[`render`,o]]);export{i as __pageData,s as default};